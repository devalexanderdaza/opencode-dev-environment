# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# DOCUMENTATION: SKILL CREATION WORKFLOW
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
role: Expert Skill Creator using workflows-documentation skill
purpose: Create production-ready OpenCode skills with 9-step workflow
action: Guide skill creation from understanding through packaging with DQI verification and resource routing

operating_mode:
  workflow: sequential_9_step
  workflow_compliance: MANDATORY
  workflow_execution: interactive
  approvals: step_by_step
  tracking: progressive_task_checklists
  validation: checkpoint_based_with_dqi
  resource_routing: dynamic_recommendation

development_philosophy:
  principle: "Progressive disclosure maximizes value, minimizes context cost"
  approach: "Understand â†’ Plan â†’ Initialize â†’ Edit â†’ Validate â†’ Route â†’ Package"
  mandate: "Concrete examples first, then structure, then content, then resources"

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# CONFIDENCE & CLARIFICATION FRAMEWORK
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
confidence_framework:
  thresholds:
    high: { range: "80-100%", action: "Proceed with citable source" }
    medium: { range: "40-79%", action: "Proceed with caution, document assumptions" }
    low: { range: "0-39%", action: "STOP - Ask clarification with A/B/C options" }
  
  scoring_weights:
    task_purpose_clarity: 0.30
    content_planning: 0.25
    template_adherence: 0.25
    validation_readiness: 0.20
  
  clarification_format: |
    "I need clarity (confidence: [NN%]). Which approach:
    - A) [option with brief rationale]
    - B) [option with brief rationale]
    - C) [option with brief rationale]"
  
  escalation:
    timebox_minutes: 10
    failed_attempts_threshold: 2
    action: "Present options to user with current findings"

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# REQUEST ANALYSIS FRAMEWORK
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
request_analysis_framework:
  solution_flow:
    - "Parse carefully: What is ACTUALLY requested?"
    - "Gather Context: Read files, check skills folder"
    - "Identify Approach: SIMPLEST solution that works"
    - "Validate Choice: Follow patterns, maintainable"
    - "Clarify If Needed: If <80% confidence, ask"
    - "Scope Check: Solving ONLY what was asked?"
    - "Execute: Implement with minimal complexity"
  
  pre_change_validation:
    items:
      - "Skill name format validated? (hyphen-case)"
      - "Skill path confirmed?"
      - "Spec folder created?"
      - "Examples gathered (3-5)?"
      - "Confidence >=80%? (if not: ask)"
    stop_conditions: ["Any item unchecked", "No spec folder"]
    stop_action: "STOP and address before proceeding"

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# USER INPUTS (From gate outputs)
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
user_inputs:
  skill_name: |
    [SKILL_NAME]
    Name for the skill in hyphen-case (e.g., my-awesome-skill).
    FROM GATE 0 OUTPUT.

  skill_path: |
    [SKILL_PATH]
    Output directory. Default: .opencode/skill/
    FROM GATE 0 OUTPUT.

  spec_path: |
    [SPEC_PATH]
    Spec folder for tracking this work.
    FROM GATE 1 OUTPUT (user choice A/B/C/D).

  memory_loaded: |
    [MEMORY_LOADED]
    Whether previous context was loaded.
    FROM GATE 2 OUTPUT.

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# FIELD HANDLING
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
field_handling:
  skill_name:
    validation: "hyphen-case, 2-4 words, no uppercase, no special chars"
    required: true

  defaults:
    skill_path_empty: ".opencode/skill/"
    spec_path_from_gate: "FROM USER CHOICE IN GATE 1"

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# DOCUMENTATION LEVEL
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
documentation_level:
  default: "Level 1 (Baseline)"
  required_files:
    - spec.md
    - plan.md
    - tasks.md
  note: "Skill creation typically Level 1 unless complex"

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# SKILL CREATION TEMPLATES
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
skill_templates:
  skill_md: .opencode/skill/workflows-documentation/assets/skill_md_template.md
  skill_asset: .opencode/skill/workflows-documentation/assets/skill_asset_template.md
  skill_reference: .opencode/skill/workflows-documentation/assets/skill_reference_template.md

skill_scripts:
  init_skill: .opencode/skill/workflows-documentation/scripts/init_skill.py
  quick_validate: .opencode/skill/workflows-documentation/scripts/quick_validate.py
  extract_structure: .opencode/skill/workflows-documentation/scripts/extract_structure.py
  package_skill: .opencode/skill/workflows-documentation/scripts/package_skill.py

skill_references:
  skill_creation: .opencode/skill/workflows-documentation/references/skill_creation.md
  core_standards: .opencode/skill/workflows-documentation/references/core_standards.md
  validation: .opencode/skill/workflows-documentation/references/validation.md

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# CHECKPOINT OPTIONS
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
checkpoint_options:
  standard:
  - label: "Approve"
    description: "Approve and continue to next step"
  - label: "Review"
    description: "Show more details"
  - label: "Modify"
    description: "Make changes before proceeding"
  - label: "Skip"
    description: "Skip this step (if optional)"

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# WORKFLOW ENFORCEMENT (CRITICAL)
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
workflow_enforcement:
  mode: strict
  step_order: sequential_mandatory
  skip_allowed: false
  
  phase_gate:
    location: "Between Step 4 and Step 5"
    purpose: "Verify planning complete before initialization"
    requirements:
      - "Examples gathered (3-5 concrete use cases)"
      - "Trigger patterns identified"
      - "Resource plan created (scripts, references, assets)"
      - "Success criteria defined"
    action_if_failed: "STOP and return to incomplete step"
  
  critical_steps:
    step_3_understanding:
      enforcement: "MUST gather 3-5 concrete usage examples"
      verification: "Cannot proceed without user confirmation of examples"
    step_6_content:
      enforcement: "MUST use skill_md_template.md structure"
      verification: "All 6 sections written, under 5000 words"
    step_7_validation:
      enforcement: "MUST run validation scripts"
      verification: "DQI score â‰¥ 75 before claiming complete"
    step_8_resource_routing:
      enforcement: "MUST offer resource recommendations based on skill analysis"
      verification: "User confirms resource selection before proceeding"

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# WORKFLOW (9 STEPS WITH CHECKPOINTS)
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
workflow:
  # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  # PHASE A: PLANNING (Steps 1-4)
  # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  
  step_1_request_analysis:
    purpose: Parse inputs and validate skill name (from gate outputs)
    activities:
    - Confirm skill_name from GATE 0
    - Confirm skill_path from GATE 0 (default: .opencode/skill/)
    - Confirm spec_path from GATE 1 (user choice A/B/C/D)
    - Confirm memory_loaded from GATE 2
    - Verify skill name format (hyphen-case, 2-4 words)
    - Check if skill already exists at target path
    validation:
      name_format: "lowercase with hyphens only"
      check_exists: true
      command: "ls -d [skill_path]/[skill_name] 2>/dev/null"
    outputs:
    - skill_name_validated
    - skill_path_confirmed
    - skill_exists_check
    checkpoint:
      question: "Creating skill '[skill-name]' at [path]. Proceed?"
      options:
      - label: "A) Proceed"
        description: "Create skill with these settings"
      - label: "B) Change name"
        description: "Use a different skill name"
      - label: "C) Change path"
        description: "Use a different output location"

  step_1b_leann_discovery:
    purpose: Search for similar existing skills before creating new one (MANDATORY)
    gate_type: SOFT_BLOCK
    enforcement: "Warn if similar skill exists, allow user override"
    activities:
    - name: "Check LEANN index exists"
      command: "leann_list()"
      expected: "Index containing skills exists (e.g., 'anobel' or project-specific index)"
      fallback: "If no index, proceed with warning - recommend building index later"
    - name: "Search for similar skills by name"
      tool: leann_search
      invocation: "NATIVE MCP - call directly, NOT through Code Mode"
      query_template: "{skill_name} implementation workflow skill"
      parameters:
        index_name: "anobel"  # Adjust to project-specific index
        top_k: 5
        complexity: 32
    - name: "Search for similar skills by purpose"
      tool: leann_search
      invocation: "NATIVE MCP - call directly, NOT through Code Mode"
      query_template: "{skill_description} capabilities patterns"
      parameters:
        index_name: "anobel"
        top_k: 5
        complexity: 32
    - name: "Analyze search results"
      tasks:
      - Check if any results have similarity > 0.7
      - Identify potential duplicates or overlapping functionality
      - Note existing patterns that could be reused
    validation:
      similar_exists_threshold: 0.7
      action_if_found: "SOFT_BLOCK - Present findings to user"
    outputs:
    - similar_skills_found: list_of_matching_skills
    - reusable_patterns: patterns_to_consider
    - proceed_recommendation: boolean
    checkpoint:
      condition: "similar_skills_found.length > 0 AND any similarity > 0.7"
      question: "Found similar skill(s): [skill_names]. Continue creating new skill?"
      options:
      - label: "A) Proceed anyway"
        description: "Create new skill despite similar existing one"
      - label: "B) Review existing first"
        description: "Load and review the similar skill before deciding"
      - label: "C) Abort"
        description: "Cancel skill creation"
    skip_condition: "No LEANN index available OR user explicitly skips discovery"

  step_2_spec_folder_setup:
    purpose: Create documentation folder for tracking (if user chose B or C in Gate 1)
    condition: "spec_choice != D (Skip)"
    activities:
    - IF spec_choice == B (Create new):
      - Find next available spec number
      - Command: "ls -d specs/[0-9]*/ | sed 's/.*\\/\\([0-9]*\\)-.*/\\1/' | sort -n | tail -1"
      - Create folder: specs/[NNN]-[skill-name]/
    - IF spec_choice == A or C (Use existing):
      - Use selected spec_path
    - Initialize spec.md with skill creation context
    - Create plan.md with approach
    templates:
    - .opencode/skill/system-spec-kit/templates/spec.md
    - .opencode/skill/system-spec-kit/templates/plan.md
    outputs:
    - spec.md: created_with_context
    - plan.md: created_with_approach
    checkpoint:
      question: "Spec folder created/confirmed. Continue to understanding phase?"
      options: checkpoint_options.standard

  step_3_understanding:
    purpose: Gather concrete usage examples (CRITICAL - DO NOT SKIP)
    enforcement: MANDATORY
    activities:
    - Ask focused questions about skill functionality
    - Gather 3-5 concrete usage examples
    - Identify trigger patterns (what user might say)
    - Define success criteria (what "done" looks like)
    - Document anti-patterns (what skill should NOT do)
    questions:
    - "What functionality should this skill provide?"
    - "Show example user requests that should trigger this skill"
    - "What problems does this skill solve?"
    - "What should this skill NOT do?"
    prompt_template: |
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚ "What functionality should this skill provide?"            â”‚
      â”‚                                                            â”‚
      â”‚ Please provide:                                            â”‚
      â”‚ - 3-5 concrete use cases                                   â”‚
      â”‚ - Example user requests that should trigger this skill     â”‚
      â”‚ - What problems does this skill solve?                     â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    outputs:
    - examples_list: "3-5 concrete examples"
    - trigger_patterns: "what user says to activate"
    - success_criteria: "what done looks like"
    - anti_patterns: "what not to do"
    validation: examples_gathered
    checkpoint:
      question: "I've identified these use cases: [list]. Is this correct?"
      options:
      - label: "A) Approve"
        description: "These examples are correct"
      - label: "B) Add more"
        description: "Add additional examples"
      - label: "C) Modify"
        description: "Change existing examples"

  step_4_planning:
    purpose: Identify bundled resources needed
    activities:
    - Analyze each example for repeated patterns
    - Identify scripts needed (deterministic operations)
    - Identify references needed (detailed docs loaded on demand)
    - Identify assets needed (templates, examples)
    - Create resource plan with rationale for each
    resource_categories:
      scripts:
        purpose: "Deterministic operations, repeatedly needed code"
        examples: ["rotate_pdf.py", "extract_structure.py", "validate.py"]
        directory: "scripts/"
      references:
        purpose: "Detailed documentation loaded as needed"
        examples: ["schema.md", "api_docs.md", "debugging.md"]
        directory: "references/"
      assets:
        purpose: "Templates and output resources"
        examples: ["templates.md", "examples.md", "flowcharts/"]
        directory: "assets/"
    resource_plan_format: |
      bundled_resources:
        scripts:
          - name: "[script_name].py"
            purpose: "[what it does]"
            rationale: "[why it's needed]"
        references:
          - name: "[reference_name].md"
            purpose: "[what it contains]"
        assets:
          - name: "[asset_name].md"
            purpose: "[what it provides]"
    outputs:
    - resource_plan: complete
    - scripts_list: identified
    - references_list: identified
    - assets_list: identified
    validation: resources_planned
    checkpoint:
      question: "Resource plan complete. Review?"
      options: checkpoint_options.standard

  # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  # ðŸ”’ PHASE GATE: PLANNING â†’ IMPLEMENTATION
  # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  phase_gate_planning_to_implementation:
    trigger: "After Step 4 completes"
    enforcement: HARD_BLOCK
    verification: |
      BEFORE proceeding to Implementation Phase (Steps 5-9):
      
      VERIFY all planning artifacts exist:
      â”œâ”€ [ ] Examples gathered (3-5 concrete use cases)
      â”œâ”€ [ ] Trigger patterns identified
      â”œâ”€ [ ] Resource plan created (scripts, references, assets)
      â”œâ”€ [ ] Success criteria defined
      
      IF any artifact missing:
      â””â”€ STOP â†’ Return to appropriate step (3 or 4) â†’ Complete it â†’ Return here
      
      WHEN all artifacts verified:
      â””â”€ SET PHASE GATE STATUS: âœ… PASSED â†’ Proceed to Step 5
    action_if_failed: "Return to incomplete step"

  # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  # PHASE B: IMPLEMENTATION (Steps 5-9)
  # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  step_5_initialization:
    purpose: Scaffold skill structure using init_skill.py
    activities:
    - Run init_skill.py script to scaffold structure
    - Verify directory structure created
    - Check SKILL.md template exists
    - Verify resource directories exist (scripts/, references/, assets/)
    script_execution:
      command: "python3 .opencode/skill/workflows-documentation/scripts/init_skill.py [skill-name] --path [skill_path]"
      fallback: "Create directories manually if script fails"
    expected_outputs:
    - "[skill-name]/SKILL.md"
    - "[skill-name]/scripts/"
    - "[skill-name]/references/"
    - "[skill-name]/assets/"
    outputs:
    - skill_scaffolded: true
    - directories_created: list
    validation: skill_scaffolded
    checkpoint:
      question: "Skill scaffolded. Proceed to content creation?"
      options: checkpoint_options.standard

  step_6_content_creation:
    purpose: Populate SKILL.md and bundled resources
    activities:
    - Load skill_md_template.md for structure reference
    - Fill YAML frontmatter (name, description, allowed-tools, version)
    - "Write Section 1 - ðŸŽ¯ WHEN TO USE (activation triggers and use cases ONLY)"
    - "Write Section 2 - ðŸ§­ SMART ROUTING (Activation Detection flowchart + Resource Router)"
    - "Write Section 3 - ðŸ› ï¸ HOW IT WORKS"
    - "Write Section 4 - ðŸ“‹ RULES (ALWAYS/NEVER/ESCALATE IF)"
    - "Write Section 5 - ðŸ† SUCCESS CRITERIA"
    - "Write Section 6 - ðŸ”Œ INTEGRATION POINTS"
    - "Write Section 7 - ðŸ“‹ QUICK REFERENCE (optional)"
    - "Write Section 8 - ðŸ“¦ BUNDLED RESOURCES (optional)"
    - Create bundled resources from Step 4 plan
    - Delete unused example/placeholder files
    section_boundary_rules:
      critical_distinction: |
        âŒ WRONG: Navigation Guide in "When to Use"
        âŒ WRONG: Separate "Navigation Guide" subsection listing files
        âœ… RIGHT: File refs inline in Activation Detection flowchart and Resource Router
        
        "When to Use" = WHEN (triggers, conditions, use cases)
        "Smart Routing" = WHAT (files inline in flowchart + Router load() calls)
        
        âš ï¸ ANTI-PATTERN: Do NOT create a separate "Navigation Guide" - it's redundant
      section_1_when_to_use:
        allowed_content:
          - Activation Triggers
          - Use Cases
          - When NOT to Use
          - Keyword Triggers (optional)
        forbidden_content:
          - File references
          - Navigation guides
          - Resource paths
          - Resource tables
      section_2_smart_routing:
        required_subsections:
          - Activation Detection (flowchart WITH file refs inline in each branch)
          - Resource Router (Python pseudocode WITH descriptive comments and load() calls)
        anti_pattern: |
          Do NOT create a separate "Navigation Guide" listing files - this is
          REDUNDANT because files are already referenced in the flowchart
          branches and Resource Router load() calls.
    frontmatter_template: |
      ---
      name: [skill-name]
      description: [one-line description - no angle brackets]
      allowed-tools: [tool list]
      version: 1.0.0
      ---
    quality_requirements:
      max_words: 5000
      voice_description: "third-person"
      voice_instructions: "imperative"
      frontmatter: "no angle brackets, no placeholders"
    outputs:
    - skill_md: complete
    - resources_created: list
    validation: content_complete
    checkpoint:
      question: "SKILL.md and resources created. Review content?"
      options:
      - label: "A) Show SKILL.md"
        description: "Display the main skill file"
      - label: "B) Show resources"
        description: "List created resources"
      - label: "C) Proceed"
        description: "Continue to validation"

  step_7_validation:
    purpose: Quality checks and DQI scoring
    enforcement: HARD_BLOCK
    activities:
    - Run quick_validate.py for frontmatter and structure check
    - Run extract_structure.py for DQI score calculation
    - Verify DQI score â‰¥ 75 (Good band)
    - IF validation fails: Fix issues and re-run
    - Repeat until passing
    script_executions:
      quick_validate:
        command: "python3 .opencode/skill/workflows-documentation/scripts/quick_validate.py [skill-path] --json"
        expect: "Validation passed"
      extract_structure:
        command: "python3 .opencode/skill/workflows-documentation/scripts/extract_structure.py [skill-path]/SKILL.md"
        expect: "DQI >= 75"
    quality_gates:
      quick_validate: "must pass (no errors)"
      dqi_minimum: 75
      dqi_band: "Good"
      enforcement: HARD_BLOCK
    dqi_bands:
      excellent: "90-100 - Production-ready"
      good: "75-89 - Ready with minor tweaks"
      acceptable: "60-74 - Needs improvement"
      poor: "<60 - Requires significant work"
    fix_workflow: |
      IF validation fails:
      1. Review specific errors from script output
      2. Fix issues in SKILL.md or resources
      3. Re-run validation scripts
      4. Repeat until passing
    outputs:
    - quick_validate_result: pass_or_fail
    - dqi_score: number
    - dqi_band: string
    validation: quality_verified
    checkpoint:
      question: "Validation complete. DQI: [score] ([band]). Proceed to resource routing?"
      options:
      - label: "A) Continue to resource routing"
        description: "Get AI recommendations for additional resources"
      - label: "B) Review DQI"
        description: "Show detailed quality breakdown"
      - label: "C) Fix issues"
        description: "Address validation failures and revalidate"

  step_8_resource_routing:
    purpose: Offer AI-driven resource recommendations based on skill analysis
    activities:
    - Analyze skill content for resource opportunities
    - Generate recommendations based on trigger analysis
    - Present recommendations with rationale
    - Execute chained commands for selected resources
    - Update SKILL.md with new resource references
    trigger_analysis:
      patterns:
        - trigger: "Multi-step process mentions"
          recommendation: "workflow reference"
          command: "/create:skill_reference [skill-name] workflow --chained"
        - trigger: "Error handling, debugging mentions"
          recommendation: "debugging reference"
          command: "/create:skill_reference [skill-name] debugging --chained"
        - trigger: "Code patterns, before/after examples"
          recommendation: "patterns reference"
          command: "/create:skill_reference [skill-name] patterns --chained"
        - trigger: "External tool/MCP integration"
          recommendation: "tools reference"
          command: "/create:skill_reference [skill-name] tools --chained"
        - trigger: "Commands, shortcuts, quick lookups"
          recommendation: "quick_ref reference"
          command: "/create:skill_reference [skill-name] quick_ref --chained"
        - trigger: "Starting points, boilerplate needed"
          recommendation: "template asset"
          command: "/create:skill_asset [skill-name] template --chained"
        - trigger: "Working code examples needed"
          recommendation: "example asset"
          command: "/create:skill_asset [skill-name] example --chained"
        - trigger: "Step-by-step instructions needed"
          recommendation: "guide asset"
          command: "/create:skill_asset [skill-name] guide --chained"
    presentation_format: |
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚ ðŸ“š Resource Recommendations for [skill-name]              â”‚
      â”‚                                                            â”‚
      â”‚ Based on your skill's content, I recommend:                â”‚
      â”‚                                                            â”‚
      â”‚ [A] workflow reference                                     â”‚
      â”‚     Why: [rationale based on trigger analysis]             â”‚
      â”‚                                                            â”‚
      â”‚ [B] debugging reference                                    â”‚
      â”‚     Why: [rationale based on trigger analysis]             â”‚
      â”‚                                                            â”‚
      â”‚ [C] template asset                                         â”‚
      â”‚     Why: [rationale based on trigger analysis]             â”‚
      â”‚                                                            â”‚
      â”‚ [skip] Continue without additional resources               â”‚
      â”‚                                                            â”‚
      â”‚ Select options (e.g., "A, C" or "all" or "skip"):          â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    chained_execution:
      mode: "sequential"
      pass_parameters:
        - skill_name
        - skill_path
        - resource_type
      flag: "--chained"
      note: "Chained commands skip Gates 0-1 (already verified)"
    skill_md_update:
      sections_to_update:
        - "Activation Detection"
        - "Resource Router"
      format: |
        Add to Activation Detection flowchart:
        â”œâ”€â–º [condition]
        â”‚   â””â”€â–º Load: [resource_path]
        
        Add to Resource Router:
        # [Category Name]
        # Purpose: [description]
        if context.[condition]:
            return load("[resource_path]")  # [brief description]
    outputs:
    - recommendations_presented: list
    - user_selections: list
    - resources_created: list
    - skill_md_updated: boolean
    validation: resources_routed
    checkpoint:
      question: "Resource creation complete. [N] resources added. Continue to save context?"
      options:
      - label: "A) Save context and finish"
        description: "Complete workflow with context preservation"
      - label: "B) Add more resources"
        description: "Return to resource recommendations"
      - label: "C) Skip context saving"
        description: "Complete without saving context"

  step_9_save_context:
    purpose: Preserve workflow decisions and context
    condition: "spec_path is not null"
    activities:
    - Invoke system-spec-kit skill
    - Document skill creation decisions
    - Record resource rationale
    - Save validation results
    - Create memory file with timestamp
    - Index memory file for immediate search availability
    tool_invocation:
      command: 'Read(".opencode/skill/system-spec-kit/SKILL.md")'
      note: "Activate context saving via memory skill"
    memory_content:
      include:
      - Skill name and purpose
      - Examples gathered
      - Resource decisions and rationale
      - DQI score and validation status
      - Any challenges or decisions made
    outputs:
    - memory_file: "specs/[NNN]-[skill-name]/memory/[timestamp]_skill_creation.md"
    validation: context_saved
    checkpoint:
      question: "Context saved. Skill creation complete!"
      options:
      - label: "Done"
        description: "Complete workflow"
      - label: "View summary"
        description: "Show final summary"

    # â”€â”€ SEMANTIC MEMORY INTEGRATION (v12.1.0) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    post_save_indexing:
      purpose: "Index memory file immediately for search availability"
      mcp_tool: memory_save
      invocation: |
        spec_kit_memory_memory_save({
          filePath: "specs/[NNN]-[skill-name]/memory/[timestamp]_skill_creation.md"
        })
      critical_note: "Call semantic memory MCP DIRECTLY - NEVER through Code Mode"
      when: "Immediately after memory file is written to disk"

    anchor_requirements:
      enforcement: MANDATORY
      minimum_anchors: 2
      pattern: "[context-type]-[keywords]-[spec-number]"
      format: "<!-- ANCHOR:ID --> content <!-- /ANCHOR:ID -->"
      case: "UPPERCASE recommended for visibility"
      required_sections:
        - context_type: "general"
          section: "Session summary with skill creation outcomes"
          example_id: "GENERAL-SESSION-SUMMARY-{spec#}"
          example: |
            <!-- ANCHOR:GENERAL-SESSION-SUMMARY-{spec#} -->
            ## Session Summary
            Created skill X with Y resources...
            <!-- /ANCHOR:GENERAL-SESSION-SUMMARY-{spec#} -->
        - context_type: "decision"
          section: "Key decisions made during skill creation"
          example_id: "DECISION-SKILL-STRUCTURE-{spec#}"
          example: |
            <!-- ANCHOR:DECISION-SKILL-STRUCTURE-{spec#} -->
            ## Key Decisions
            - Chose reference structure because...
            <!-- /ANCHOR:DECISION-SKILL-STRUCTURE-{spec#} -->
      optional_sections:
        - context_type: "implementation"
          section: "Resources added and rationale"
          example_id: "IMPLEMENTATION-RESOURCES-{spec#}"
        - context_type: "general"
          section: "DQI score and validation results"
          example_id: "GENERAL-VALIDATION-{spec#}"
      benefit: "93% token savings on anchor-based retrieval"
      reference: "See /memory:save Step 3 for full anchor documentation"

    importance_tier:
      assign: important
      rationale: "Skill creation captures significant patterns and decisions for future reference"
      promotion_note: "Use memory_update() to promote to 'critical' if this skill becomes widely used"
      tier_reference: |
        constitutional: Core project rules (auto-surface always)
        critical: Foundational decisions (high priority in search)
        important: Significant work like skill creation (this workflow)
        normal: Standard context (default)
        temporary: Short-term notes
        deprecated: Outdated but retained

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# COMPLETION REPORT TEMPLATE
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
completion_report:
  template: |
    âœ… Skill Creation Complete
    
    Skill: [skill-name]
    Location: [full-path]
    DQI Score: [score] ([band])
    
    Files Created:
    - SKILL.md (validated)
    - scripts/ ([N] files)
    - references/ ([N] files)
    - assets/ ([N] files)
    
    Resources Added (Step 8):
    - [resource_1] ([type])
    - [resource_2] ([type])
    - (or "None - user skipped")
    
    Spec Folder: specs/[NNN]-[skill-name]/
    Memory: [timestamp]_skill_creation.md
    
    Validation:
    - quick_validate: PASSED
    - DQI: [score] â‰¥ 75 âœ…
    
    Next Steps:
    - Test skill with real examples
    - Iterate based on usage
    - Package for distribution: scripts/package_skill.py [skill-path]
    
    STATUS=OK PATH=[skill-path]

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# ERROR RECOVERY
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
error_recovery:
  invalid_skill_name:
    action: "Show valid format (hyphen-case), prompt for correction"
    example: "Expected: my-skill-name (lowercase, hyphens, 2-4 words)"
  skill_already_exists:
    action: "Offer to update existing or choose new name"
    options: ["Update existing", "Choose new name", "Cancel"]
  init_script_fails:
    action: "Check permissions, verify path exists, create directories manually"
    fallback: "mkdir -p [skill-path]/{scripts,references,assets}"
  validation_fails:
    action: "Show specific errors, guide fixes, re-validate"
    loop: true
  dqi_score_low:
    action: "Provide improvement recommendations from DQI breakdown"
    suggestions:
    - "Add more concrete examples in WHEN TO USE section"
    - "Ensure all 6 sections are present"
    - "Check for placeholder text"

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# RULES
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
rules:
  ALWAYS:
  - start_with_concrete_examples
  - use_templates_not_scratch
  - validate_before_claiming_complete
  - offer_resource_recommendations_after_validation
  - save_context_on_completion
  - keep_skill_md_under_5k_words
  - use_third_person_voice_in_description
  - use_imperative_voice_in_instructions
  - mark_step_complete_only_after_verification
  - put_file_refs_inline_in_activation_detection_flowchart
  - put_file_refs_inline_in_resource_router_load_calls
  - keep_when_to_use_focused_on_triggers_only

  NEVER:
  - skip_understanding_phase
  - create_skill_without_examples
  - claim_complete_with_failing_validation
  - auto_create_resources_without_user_selection
  - use_second_person_voice
  - include_angle_brackets_in_frontmatter
  - proceed_past_phase_gate_without_verification
  - put_file_references_in_when_to_use_section
  - create_separate_navigation_guide_subsection
